<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="../../css/mui.min.css" rel="stylesheet" />
		<link rel="stylesheet" type="text/css" href="../../css/utils/pullToRefresh.css" />
		<link href="../../css/mui.picker.min.css" rel="stylesheet" />
		<link href="../../css/mui.poppicker.css" rel="stylesheet" />
		<link href="../../css/icons-extra.css" rel="stylesheet" />
		<style>
			[v-cloak] {
				visibility: hidden;
			}
			body{
				background: #fff;
			}
			.mui-segmented-control{
				border: 0px;
				background: #F0F0F0;
			}
			.mui-segmented-control .mui-control-item{
				color: #0D0D0D;
				border: 0px;
			}			
			.mui-segmented-control .mui-control-item.mui-active {
			    color: #0D0D0D;
			    background-color: transparent;
			}
			.mui-segmented-control .mui-control-item span{
				font-size: 12px;
				padding: 0 0 0 5px;
			}
			.mui-ellipsis{
				font-size: 13px;
				float: left;
				color: #999999;
				width: 75%;
			}
			.mui-table-view-cell:after{
				left:0px;
			}
			
			
			.mui-icon-extra-calendar:before {
				content:''
			}
			.mui-icon-extra-calendar:after {
				font-size: 20px;
				color: #6ABBF0;
				vertical-align: middle;
			    content: "\e115";
			}
			.mui-table-view:before {
			    height: 0px;
			}
			
			.dl{
				font-size: 14px;
				margin-left: 15px;
				color: #8f8f94;
			}
			.dr{
				color: #8f8f94;
				font-size: 14px;
				float: right;
			}
			.line {
				margin-right: ;
			    height: 1px;-15px
			    -webkit-transform: scaleY(.5);
			    transform: scaleY(.5);
			    background-color: #c8c7cc;
			}
			.spdiv{
				line-height: 2;
			}
			.mui-table-view-cell.mui-collapse .mui-collapse-content {
			    padding: 0 15px;
			}
			
			.title-info {
				padding: 18px 0 5px 0;
				text-align: center;
				background: #fff;
			}
			.user-title {
				font-size: 17px;
				color: #333333;
				font-weight: bold;
			}
			.user-time{
				font-size: 13px;
				color: #8f8f94;
			}
		</style>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav" style="background-color:#63BBFF;" id="actionHead">
			<a onclick="mui.back()" class="mui-icon mui-icon-left-nav mui-pull-left" style="color: white;"></a>
			<h1 class="mui-title" style="color: white;">统计报表</h1>
		</header>
		<div id="selectTitle">
			<div class="mui-content" style="position: fixed;z-index: 8;background: #fff;">
				<div class="mui-segmented-control" >
					<a class="mui-control-item" v-cloak href="javascript:void(0)" @tap="selectGrade()"><span>{{grade}}</span><span class="mui-icon mui-icon-arrowdown"></span></a>
					<a class="mui-control-item" v-cloak href="javaScript:void(0)" @tap="selectClass()"><span>{{classes}}</span><span class="mui-icon mui-icon-arrowdown"></span></a>
				</div>
				<div class="mui-row title-info">
					<p v-cloak class="user-title">{{title}}</p>
					<span class="user-time">周期：</span>
					<span class="user-time mui-icon-extra mui-icon-extra-calendar" @click="selectTime($event,1)" data-options='{"type":"date"}'>{{startTime}}</span>
					<span class="user-time">&nbsp;至&nbsp;</span>
					<span class="user-time mui-icon-extra mui-icon-extra-calendar" @click="selectTime($event,2)" data-options='{"type":"date"}'>{{endTime}}</span>
				</div>
			</div>
			<div class="mui-content mui-fullscreen" style="z-index: 6;background: #fff;margin-top: 115px;">
				<ul class="mui-table-view">
					<li class="mui-table-view-cell keep-unfold mui-collapse">
						<a class="mui-navigate-right" href="#">总计</a>
						<div class="mui-collapse-content">
							<div class="spdiv"><span class="dl">上课吵闹</span><span class="dr">2次</span></div>
							<div class="line"></div>
							<div class="spdiv"><span class="dl">上课打架</span><span class="dr">2次</span></div>
							<div class="line"></div>
							<div class="spdiv"><span class="dl">上课迟到</span><span class="dr">2次</span></div>
						</div>
					</li>
					<li class="mui-table-view-cell keep-unfold mui-collapse">
						<a class="mui-navigate-right" href="#">一年级</a>
						<div class="mui-collapse-content">
							<div class="spdiv"><span class="dl">上课吵闹</span><span class="dr">2次</span></div>
							<div class="line"></div>
							<div class="spdiv"><span class="dl">上课打架</span><span class="dr">2次</span></div>
							<div class="line"></div>
							<div class="spdiv"><span class="dl">上课迟到</span><span class="dr">2次</span></div>
						</div>
					</li>
					<li class="mui-table-view-cell keep-unfold mui-collapse">
						<a class="mui-navigate-right" href="#">二年级</a>
						<div class="mui-collapse-content">
							<div class="spdiv"><span class="dl">上课吵闹</span><span class="dr">2次</span></div>
							<div class="line"></div>
							<div class="spdiv"><span class="dl">上课打架</span><span class="dr">2次</span></div>
							<div class="line"></div>
							<div class="spdiv"><span class="dl">上课迟到</span><span class="dr">2次</span></div>
						</div>
					</li>
					<li class="mui-table-view-cell keep-unfold mui-collapse">
						<a class="mui-navigate-right" href="#">三年级</a>
						<div class="mui-collapse-content">
							<div class="spdiv"><span class="dl">上课吵闹</span><span class="dr">2次</span></div>
							<div class="line"></div>
							<div class="spdiv"><span class="dl">上课打架</span><span class="dr">2次</span></div>
							<div class="line"></div>
							<div class="spdiv"><span class="dl">上课迟到</span><span class="dr">2次</span></div>
						</div>
					</li>
				</ul>
			</div>
		</div>
		<script src="../../js/mui.js"></script>
		<script src="../../js/mui/mui.picker.min.js"></script>
		<script src="../../js/mui/mui.poppicker.js"></script>
		<script src="../../js/utils/vue.min.js"></script>
		<script src='../../js/utils/vconsole.min.js'></script>
		<script src="../../js/publicProtocol.js"></script>
		<script src="../../js/utils/store.js"></script>
		<script src="../../js/storageKeyName.js"></script>
		<script src="../../js/utils/events.js"></script>
		<script type="text/javascript" src="../../js/publicProtocol.js"></script>
		<script src="../../js/utils/utils.js"></script>
		<script src="../../js/libs/jquery.js"></script>
		<script src="../../js/mui.pullToRefresh.js"></script>
		<script src="../../js/mui.pullToRefresh.material.js"></script>
		<script type="text/javascript">
			var m$=mui.init()
			mui.plusReady(function(){
			});
			var selectTitle =new Vue({
				el:"#selectTitle",
				data:{
					grade:'全部年级',
					classes:'全部班级',
					title:'全校学生行为统计',
					startTime:'2018-06-23',
					endTime:'2018-06-28',
					list:[ {value: '1',text: '全部年级',children: [{value: "10",text: "全部班级"}]},
						   {value: '2',text: '初中一年级',children: [{value: "20",text: "全部班级"},{value: "21",text: "10111班"},{value: "22",text: "10112班"}]},
						   {value: '3',text: '二年级',children: [{value: "30",text: "全部班级"},{value: "31",text: "一班"},{value: "32",text: "10112班"}]}
						 ]
				},
				methods:{
					selectGrade:function(){
						var userPicker = new m$.PopPicker({layer: 2});
						userPicker.setData(selectTitle.list);
						userPicker.show(function(items) {
							var grade=_getParam(items[0], 'text');
							var classes=_getParam(items[1], 'text');
							selectTitle.grade=grade;
							selectTitle.classes=classes;
							var tit='';
							if(grade.indexOf('全部')!=-1&&classes.indexOf('全部')!=-1){
								tit='全校学生行为统计'
							}else if(grade.indexOf('全部')==-1&&classes.indexOf('全部')!=-1){
								tit=grade+'学生行为统计'
							}else if(grade.indexOf('全部')==-1&&classes.indexOf('全部')==-1){
								tit=grade+classes+'学生行为统计'
							}
							selectTitle.title=tit;
							console.log("你选择的城市是:" + _getParam(items[0], 'text') + " " + _getParam(items[1], 'text'));
						});
					},
					selectClass:function(){
						this.$options.methods.selectGrade();
					},
					selectTime:function(event,lx){
						var _self = event.target;
						var optionsJson = _self.getAttribute('data-options') || '{}';
						var options = JSON.parse(optionsJson);
						_self.picker = new m$.DtPicker(options);
						_self.picker.show(function(rs) {
							if(lx=='1'){
								if(compairTime(rs.text,selectTitle.endTime)){
									selectTitle.startTime=rs.text;
								}else{
									mui.toast('开始时间不能晚于结束时间');
								}
							}else{
								if(compairTime(selectTitle.startTime,rs.text)){
									selectTitle.endTime=rs.text;
								}else{
									mui.toast('结束时间不能早于开始时间');
								}
								
							}
							_self.picker.dispose();
							_self.picker = null;
						});
					}
				}
			}); 
			
			var _getParam = function(obj, param) {
				return obj[param] || '';
			}
			
			//比对时间大小
			function compairTime(startTime,endTime){
				var start = new Date(startTime.replace("-", "/").replace("-", "/"));
				var end = new Date(endTime.replace("-", "/").replace("-", "/"));
				if(end>start){
					return true;
				}
				return false;
			}
			
			
		</script>
	</body>
 
</html>